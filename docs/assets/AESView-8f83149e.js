import{d as e,a,b as l,k as u,l as t,g as s,i as r,j as n,h as d}from"./element-plus-a17310d1.js";import{u as o,b as c}from"./vue-router-c701b404.js";import{C as v}from"./crypto-js-de9b8be2.js";import{a as i}from"./clipboard-b18db9e2.js";import{d as p,c as f}from"./pinia-2a9439bb.js";import{r as m,u as b}from"./@vue-67bd3c9a.js";import{k as y,w as g,o as U,c as B,A as k,y as V,K as _,F as E,O as h,x as j,t as C,Y as x,Z as S,a as L}from"./vue-e1fd4543.js";import{_ as P}from"./index-c2408dab.js";import"./@vueuse-cc804279.js";import"./@popperjs-b78c3215.js";import"./@element-plus-893dda61.js";import"./lodash-es-7b2175ad.js";import"./memoize-one-63ab667a.js";import"./@ctrl-a951068a.js";import"./bcryptjs-638ef99f.js";import"./vue-clipboard3-12a5795a.js";import"./clipboard-b5f6a829.js";const w=p("aes",{state:()=>({key:m("1234567890ABCDEF"),iv:m("abcdefghijklmnop"),defaultMode:m("ECB"),mode:m(),defaultPadding:m("Pkcs7"),padding:m()}),getters:{getKey:e=>e.key,getIv:e=>e.iv,getMode:e=>void 0===e.mode?e.defaultMode:e.mode,getPadding:e=>void 0===e.padding?e.defaultPadding:e.padding},actions:{setKey(e){this.key=e},setIv(e){this.iv=e},setMode(e){this.mode=e},setPadding(e){this.padding=e}}})(f());w.$subscribe(((e,a)=>{localStorage.setItem(w.$id,JSON.stringify({...a}))}));const O=localStorage.getItem(w.$id);O&&(w.$state=JSON.parse(O));const I=e=>(x("data-v-5d522f8a"),e=e(),S(),e),A=I((()=>L("h1",null,"AES 对称性加密",-1))),J=I((()=>L("br",null,null,-1))),N=I((()=>L("br",null,null,-1))),q=I((()=>L("br",null,null,-1))),D=I((()=>L("span",null,"秘钥 key",-1))),F=I((()=>L("span",null,"偏移量 iv",-1))),H=I((()=>L("br",null,null,-1))),M=I((()=>L("br",null,null,-1))),T=P(y({__name:"AESView",setup(p){const f=o(),y=c(),x=m("1"===f.query.type||"2"===f.query.type?f.query.type:"1");g((()=>x.value),((e,a)=>{const l=JSON.parse(JSON.stringify(f.query));l.type=e;const u=m(l);y.replace({query:u.value})}));const S=m(w.getMode);g((()=>S.value),((e,a)=>{w.setMode(e);const l=JSON.parse(JSON.stringify(f.query));l.mode=e;const u=m(l);y.replace({query:u.value})}));const L=[{value:"ECB",label:"ECB"},{value:"CBC",label:"CBC"},{value:"CFB",label:"CFB"},{value:"CTR",label:"CTR"},{value:"OFB",label:"OFB"}],P=m(w.getPadding);g((()=>P.value),((e,a)=>{w.setPadding(e);const l=JSON.parse(JSON.stringify(f.query));l.padding=e;const u=m(l);y.replace({query:u.value})}));const O=[{value:"Pkcs7",label:"Pkcs7"},{value:"Iso97971",label:"Iso97971"},{value:"AnsiX923",label:"AnsiX923"},{value:"Iso10126",label:"Iso10126"},{value:"ZeroPadding",label:"ZeroPadding"}],I=m("Utf8"),T=[{value:"Utf8",label:"Utf8"},{value:"Hex",label:"Hex"},{value:"Latin1",label:"Latin1"},{value:"Utf16",label:"Utf16"},{value:"Utf16BE",label:"Utf16BE"},{value:"Utf16LE",label:"Utf16LE"},{value:"Base64",label:"Base64"},{value:"Base64url",label:"Base64url"}],K=m(w.getKey);g((()=>K.value),((e,a)=>{w.setKey(e)}));const R=m("Utf8"),Z=[{value:"",label:"default"},{value:"Utf8",label:"Utf8"},{value:"Hex",label:"Hex"},{value:"Latin1",label:"Latin1"},{value:"Utf16",label:"Utf16"},{value:"Utf16BE",label:"Utf16BE"},{value:"Utf16LE",label:"Utf16LE"},{value:"Base64",label:"Base64"},{value:"Base64url",label:"Base64url"}],X=m(w.getIv);g((()=>X.value),((e,a)=>{w.setIv(e)}));const $=m("Utf8"),z=[{value:"",label:"default"},{value:"Utf8",label:"Utf8"},{value:"Hex",label:"Hex"},{value:"Latin1",label:"Latin1"},{value:"Utf16",label:"Utf16"},{value:"Utf16BE",label:"Utf16BE"},{value:"Utf16LE",label:"Utf16LE"},{value:"Base64",label:"Base64"},{value:"Base64url",label:"Base64url"}],Y=m(""),G=m(!0),Q=m(""),W=m("my message"),ee=e=>{W.value=e?Q.value:Y.value};g((()=>G.value),((e,a)=>{ee(e)}));const ae=m(""),le=()=>{const a=re(R.value,K.value);try{if("1"===x.value)ae.value=v.AES.encrypt(W.value,a,{mode:te(S.value),padding:se(P.value)}).toString();else{const e=re($.value,X.value);ae.value=v.AES.encrypt(W.value,a,{ivParse:e,mode:te(S.value),padding:se(P.value)}).toString()}e({message:"加密完成",type:"success"})}catch(l){"1"===x.value?e.error("加密失败，请确认秘钥 key、模式 mode、填充 padding 是否正确"):e.error("加密失败，请确认秘钥 key、偏移量 iv、模式 mode、填充 padding 是否正确")}},ue=()=>{if(""===ae.value)return void e.error("解密时，密文不能为空！");let a;const l=re(R.value,K.value);try{if("1"===x.value)a=v.AES.decrypt(ae.value,l,{mode:te(S.value),padding:se(P.value)});else{const e=v.enc.Latin1.parse(X.value);a=v.AES.decrypt(ae.value,l,{ivParse:e,mode:te(S.value),padding:se(P.value)})}}catch(u){"1"===x.value?e.error("解密失败，请确认秘钥 key、模式 mode、填充 padding 是否正确"):e.error("解密失败，请确认秘钥 key、偏移量 iv、模式 mode、填充 padding 是否正确")}if(void 0!==a)try{Y.value=a.toString(ne(I.value));try{Q.value=JSON.stringify(JSON.parse(Y.value),null,"\t"),ee(G.value)}catch(u){ee(!1)}""===Y.value?"1"===x.value?e({message:"解密结果为空，请检查秘钥与密文是否正确",type:"warning"}):e({message:"解密结果为空，请检查秘钥、偏移量与密文是否正确",type:"warning"}):e({message:"解密完成",type:"success"})}catch(u){e.error("解密后转码失败")}},te=e=>{switch(e){case"CBC":return v.mode.CBC;case"CFB":return v.mode.CFB;case"CTR":return v.mode.CTR;case"OFB":return v.mode.OFB;case"ECB":return v.mode.ECB}},se=e=>{switch(e){case"Pkcs7":return v.pad.Pkcs7;case"Iso97971":return v.pad.Iso97971;case"AnsiX923":return v.pad.AnsiX923;case"Iso10126":return v.pad.Iso10126;case"ZeroPadding":return v.pad.ZeroPadding}},re=(e,a)=>{switch(e){case"":return a;case"Hex":return v.enc.Hex.parse(a);case"Latin1":return v.enc.Latin1.parse(a);case"Utf8":return v.enc.Utf8.parse(a);case"Utf16":return v.enc.Utf16.parse(a);case"Utf16BE":return v.enc.Utf16BE.parse(a);case"Utf16LE":return v.enc.Utf16LE.parse(a);case"Base64":return v.enc.Base64.parse(a);case"Base64url":return v.enc.Base64url.parse(a)}},ne=e=>{switch(e){case"Hex":return v.enc.Hex;case"Latin1":return v.enc.Latin1;case"Utf8":return v.enc.Utf8;case"Utf16":return v.enc.Utf16;case"Utf16BE":return v.enc.Utf16BE;case"Utf16LE":return v.enc.Utf16LE;case"Base64":return v.enc.Base64;case"Base64url":return v.enc.Base64url}};return y.isReady().then((()=>{const e=JSON.parse(JSON.stringify(f.query)),a=e.mode,l=e.padding;void 0!==a&&a!==S.value&&(S.value=a),void 0!==l&&l!==P.value&&(P.value=l);const u=m(!1);for(const s in L){const e=L[s].value;if(S.value===e){u.value=!0;break}}u.value||(S.value=w.defaultMode);const t=m(!1);for(const s in O){const e=O[s].value;if(P.value===e){t.value=!0;break}}t.value||(P.value=w.defaultPadding)})),(e,o)=>{const c=a,v=l,p=u,f=t,m=s,y=r,g=n,w=d;return U(),B(E,null,[k(v,{justify:"center"},{default:V((()=>[k(c,{span:22,class:"text-center"},{default:V((()=>[A])),_:1})])),_:1}),J,k(v,{class:"text-center"},{default:V((()=>[k(c,{span:22},{default:V((()=>[k(f,{modelValue:x.value,"onUpdate:modelValue":o[0]||(o[0]=e=>x.value=e)},{default:V((()=>[k(p,{border:"",label:"1"},{default:V((()=>[_("仅秘钥 key")])),_:1}),k(p,{border:"",label:"2"},{default:V((()=>[_("秘钥 key + 偏移量 iv")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1}),N,k(v,{justify:"center",gutter:20},{default:V((()=>[k(c,{span:11},{default:V((()=>[k(m,{class:"input-readonly mode-placeholder",value:"模式 mode",readonly:""}),k(g,{modelValue:S.value,"onUpdate:modelValue":o[1]||(o[1]=e=>S.value=e),placeholder:"请选择模式",class:"mode-select"},{default:V((()=>[(U(),B(E,null,h(L,(e=>k(y,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1}),k(c,{span:11},{default:V((()=>[k(m,{class:"input-readonly padding-placeholder",value:"填充方案 padding",readonly:""}),k(g,{modelValue:P.value,"onUpdate:modelValue":o[2]||(o[2]=e=>P.value=e),placeholder:"请选择填充方案",class:"padding-select"},{default:V((()=>[(U(),B(E,null,h(O,(e=>k(y,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1})])),_:1}),q,k(v,{justify:"center",gutter:20},{default:V((()=>[k(c,{span:"1"===x.value?22:11},{default:V((()=>[k(m,{modelValue:K.value,"onUpdate:modelValue":o[4]||(o[4]=e=>K.value=e),placeholder:"请输入秘钥",clearable:"",onDblclick:b(i),"data-dblclick":"秘钥已复制到剪贴板"},{prepend:V((()=>[D])),append:V((()=>[k(g,{modelValue:R.value,"onUpdate:modelValue":o[3]||(o[3]=e=>R.value=e),placeholder:"选择秘钥编码",class:"w-100px"},{default:V((()=>[(U(),B(E,null,h(Z,(e=>k(y,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1},8,["modelValue","onDblclick"])])),_:1},8,["span"]),"2"===x.value?(U(),j(c,{key:0,span:11},{default:V((()=>[k(m,{modelValue:X.value,"onUpdate:modelValue":o[6]||(o[6]=e=>X.value=e),placeholder:"请输入偏移量",clearable:"",onDblclick:b(i),"data-dblclick":"偏移量已复制到剪贴板"},{prepend:V((()=>[F])),append:V((()=>[k(g,{modelValue:$.value,"onUpdate:modelValue":o[5]||(o[5]=e=>$.value=e),placeholder:"选择偏移量编码",class:"w-100px"},{default:V((()=>[(U(),B(E,null,h(z,(e=>k(y,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1},8,["modelValue","onDblclick"])])),_:1})):C("",!0)])),_:1}),H,k(v,{class:"button-row",justify:"center",gutter:20},{default:V((()=>[k(c,{span:11},{default:V((()=>[k(w,{onClick:le,class:"encrypt-button w-100%"},{default:V((()=>[_("加密")])),_:1})])),_:1}),k(c,{span:11},{default:V((()=>[k(g,{modelValue:G.value,"onUpdate:modelValue":o[7]||(o[7]=e=>G.value=e),placeholder:"原文是否格式化",class:"decrypt-enc-select-left w-100px"},{default:V((()=>[k(y,{label:"格式化",value:!0}),k(y,{label:"不格式化",value:!1})])),_:1},8,["modelValue"]),k(w,{onClick:ue,class:"decrypt-button"},{default:V((()=>[_("解密")])),_:1}),k(g,{modelValue:I.value,"onUpdate:modelValue":o[8]||(o[8]=e=>I.value=e),placeholder:"请选择解密编码",class:"decrypt-enc-select w-100px"},{default:V((()=>[(U(),B(E,null,h(T,(e=>k(y,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1})])),_:1}),M,k(v,{class:"text-row",justify:"center",gutter:20},{default:V((()=>[k(c,{span:11},{default:V((()=>[k(m,{modelValue:W.value,"onUpdate:modelValue":o[9]||(o[9]=e=>W.value=e),class:"originalText-input",placeholder:"原文",type:"textarea",onDblclick:b(i),rows:"15","data-dblclick":"原文已复制到剪贴板"},null,8,["modelValue","onDblclick"])])),_:1}),k(c,{span:11},{default:V((()=>[k(m,{modelValue:ae.value,"onUpdate:modelValue":o[10]||(o[10]=e=>ae.value=e),class:"ciphertext-input",placeholder:"密文",type:"textarea",onDblclick:b(i),rows:"15","data-dblclick":"密文已复制到剪贴板"},null,8,["modelValue","onDblclick"])])),_:1})])),_:1})],64)}}}),[["__scopeId","data-v-5d522f8a"]]);export{T as default};
