import{d as e,e as l,a as t,b as a,h as r,j as u,g as o,i as s}from"./element-plus-a17310d1.js";import{j as n}from"./jsrsasign-5909e7ae.js";import{J as i}from"./jsencrypt-23bdc3c6.js";import{a as c}from"./clipboard-b18db9e2.js";import{d as p,c as d}from"./pinia-2a9439bb.js";import{r as v,u as m}from"./@vue-67bd3c9a.js";import{k as y,w as f,o as b,c as g,A,y as K,K as w,F as S,O as j,Y as P,Z as k,a as h}from"./vue-e1fd4543.js";import{_ as C}from"./index-c2408dab.js";import"./@vueuse-cc804279.js";import"./@popperjs-b78c3215.js";import"./@element-plus-893dda61.js";import"./lodash-es-7b2175ad.js";import"./memoize-one-63ab667a.js";import"./@ctrl-a951068a.js";import"./vue-clipboard3-12a5795a.js";import"./clipboard-b5f6a829.js";import"./bcryptjs-638ef99f.js";import"./vue-router-c701b404.js";const x=p("rsa",{state:()=>({publicKey:v("MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCD5XD8TEL7d6EwN6WohUhLMPbx7LumqTY4hD0wHQDVB8QcOtyKiHTJEL+KnmY662gkDJnxiaeMUqX5c2AneXf3wLCYi6I8JmFqSNhOdxNdo/YvklPcmBAmxpW2grZdO4J2MWVykHrAMD07YJOKXDZcwe4HQgpoIH7hKvalcc4QnQIDAQAB"),privateKey:v("MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAIPlcPxMQvt3oTA3paiFSEsw9vHsu6apNjiEPTAdANUHxBw63IqIdMkQv4qeZjrraCQMmfGJp4xSpflzYCd5d/fAsJiLojwmYWpI2E53E12j9i+SU9yYECbGlbaCtl07gnYxZXKQesAwPTtgk4pcNlzB7gdCCmggfuEq9qVxzhCdAgMBAAECgYBYoWqOL5TnNFlddFdeacnNtSaMJR9n+9cSnVIcrbCsdl6C9c7TTKTlo9qChLR/rUa6yrj7xRuQwM0FVlFr1UUWeoiYK4A7KKSMwbe5HZkj5hZM1O9T/nqXrdI+qztqUcPMoThE1W3pSJ1SuFH2NSoWyXuyYXRdoAyTwoVSVZ4WBQJBAOeqB4PlrNCVgCveabrc/WTTSuUvu42NKG7n7huaQtrDH7uy0GIumq8MwuZl+R6ZUtyxv2CA9MK0dPyPKSkDbCcCQQCRwG2g2XPgCDXyy0Sl+GOEnkf2JWKVhuGrlCf41gwJP77JPMekSrNi0Yw27c0YwdFmrtm/GKAGhL4vYtvxo+ObAkEAqkRl0aN1KLk4wwVtYFIcS4agfWJfzuH43crJTrBKgs72+9WpIwBt4ErY1M4OE1dNd7eMmTkurAxGD3qJHgPN8QJAbIQSm0GLjm9Oi1hf4hpPLfwSo+ctwRpNhsul/xSOnYxCZd3E3kNnz9koRfVDUH1thMAGCsswyemnF+zIyN42pQJAI6ZJSx+bUacrS6yhPLKJXDRrZtp7xCGLesc6kMK6Yyaa2FcQWs+XZncPEdlFxsFgOgAsBd9s+PpCv6DRFIR9Lg==")}),getters:{getPublicKey:e=>e.publicKey,getPrivateKey:e=>e.privateKey},actions:{setPublicKey(e){this.publicKey=e},setPrivateKey(e){this.privateKey=e}}})(d());x.$subscribe(((e,l)=>{localStorage.setItem(x.$id,JSON.stringify({...l}))}));const N=localStorage.getItem(x.$id);N&&(x.$state=JSON.parse(N));const V=e=>(P("data-v-1badc5a9"),e=e(),k(),e),D=V((()=>h("h1",null,"RSA 非对称性加密",-1))),I=V((()=>h("br",null,null,-1))),_=V((()=>h("br",null,null,-1))),E=V((()=>h("br",null,null,-1))),J=V((()=>h("br",null,null,-1))),M=C(y({__name:"RSAView",setup(p){const d=v(!1),y=v("my message"),P=v(""),k=()=>{if(null===N.value||""===N.value)return void e.error("公钥加密时，公钥不能为空！");if(null===y.value||""===y.value)return void e.error("公钥加密时，原文不能为空！");i.prototype.setPrivateKey(""),i.prototype.setPublicKey(N.value);const l=i.prototype.encrypt(y.value);!1!==l?(P.value=l,e({message:"公钥加密完成",type:"success"})):e.error("公钥加密失败，请检查公钥是否正确！")},h=()=>{const l=V.value;if(null===l||""===l)return void e.error("私钥加密时，私钥不能为空！");if(null===y.value||""===y.value)return void e.error("私钥加密时，原文不能为空！");i.prototype.setPublicKey(""),i.prototype.setPrivateKey(V.value);const t=i.prototype.encrypt(y.value);!1!==t?(P.value=t,e({message:"私钥加密完成",type:"success"})):e.error("私钥加密失败，请检查私钥是否正确！")},C=()=>{if(null===V.value||""===V.value)return void e.error("私钥解密时，私钥不能为空！");if(null===P.value||""===P.value)return void e.error("私钥解密时，密文不能为空！");i.prototype.setPublicKey(""),i.prototype.setPrivateKey(V.value);const l=i.prototype.decrypt(P.value);!1!==l?null!==l?(y.value=l,e({message:"私钥解密完成",type:"success"})):e.error("私钥解密失败，请检查密文是否正确！"):e.error("私钥解密失败，请检查私钥是否正确！")},N=v(x.getPublicKey);f((()=>N.value),((e,l)=>{x.setPublicKey(e)}));const V=v(x.getPrivateKey);f((()=>V.value),((e,l)=>{x.setPrivateKey(e)}));const M=v(1024);f((()=>M.value),((e,l)=>{4096===e&&"Notification"in window&&("granted"===Notification.permission||"denied"!==Notification.permission&&Notification.requestPermission().then((function(e){})))}));const T=[{value:512,label:"512 (不推荐)"},{value:1024,label:"1024 (速度快)"},{value:2048,label:"2048 (速度慢)"},{value:4096,label:"4096 (极慢)"}],Q=async()=>{d.value?Y():2048===M.value||4096===M.value?l.confirm(`纯 JavaScript 运算，生成 ${M.value} 位 RSA 非对称秘钥对速度${2048===M.value?"慢":"极慢"}，可能会导致浏览器卡死，是否继续？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{d.value=!0,Y()})).catch((()=>{})):Y()},Y=()=>{const e=n.KEYUTIL.generateKeypair("RSA",M.value);if(N.value=n.KEYUTIL.getPEM(e.pubKeyObj),V.value=n.KEYUTIL.getPEM(e.prvKeyObj,"PKCS8PRV"),"Notification"in window&&"granted"===Notification.permission){new Notification(`生成 ${M.value} 位 RSA 非对称性加密密钥对成功`).onshow=function(){}}};return(e,l)=>{const n=t,i=a,p=r,d=s,v=u,f=o;return b(),g(S,null,[A(i,{justify:"center"},{default:K((()=>[A(n,{span:22,class:"text-center"},{default:K((()=>[D])),_:1})])),_:1}),I,A(i,{justify:"center",gutter:20},{default:K((()=>[A(n,{span:22},{default:K((()=>[A(p,{onClick:Q,class:"generate-button"},{default:K((()=>[w("生成秘钥")])),_:1}),A(v,{modelValue:M.value,"onUpdate:modelValue":l[0]||(l[0]=e=>M.value=e),placeholder:"请选择生成RSA密钥对位数",class:"generate-button-select w-150px"},{default:K((()=>[(b(),g(S,null,j(T,(e=>A(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1})])),_:1}),_,A(i,{justify:"center",gutter:20},{default:K((()=>[A(n,{span:11},{default:K((()=>[A(f,{modelValue:N.value,"onUpdate:modelValue":l[1]||(l[1]=e=>N.value=e),class:"originalText-input",placeholder:"请输入RSA公钥",type:"textarea",onDblclick:m(c),rows:"10","data-dblclick":"RSA公钥已复制到剪贴板"},null,8,["modelValue","onDblclick"])])),_:1}),A(n,{span:11},{default:K((()=>[A(f,{modelValue:V.value,"onUpdate:modelValue":l[2]||(l[2]=e=>V.value=e),class:"ciphertext-input",placeholder:"请输入RSA私钥",type:"textarea",onDblclick:m(c),rows:"10","data-dblclick":"RSA私钥已复制到剪贴板"},null,8,["modelValue","onDblclick"])])),_:1})])),_:1}),E,A(i,{justify:"center",gutter:20},{default:K((()=>[A(n,{span:11},{default:K((()=>[A(p,{onClick:k,class:"encrypt-button w-100%"},{default:K((()=>[w("公钥加密")])),_:1})])),_:1}),A(n,{span:11},{default:K((()=>[A(i,{gutter:20},{default:K((()=>[A(n,{span:12},{default:K((()=>[A(p,{onClick:h,class:"encrypt-button w-100%"},{default:K((()=>[w("私钥加密")])),_:1})])),_:1}),A(n,{span:12},{default:K((()=>[A(p,{onClick:C,class:"decrypt-button w-100%"},{default:K((()=>[w("私钥解密")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),J,A(i,{justify:"center",gutter:20},{default:K((()=>[A(n,{span:11},{default:K((()=>[A(f,{modelValue:y.value,"onUpdate:modelValue":l[3]||(l[3]=e=>y.value=e),class:"originalText-input",placeholder:"原文",type:"textarea",onDblclick:m(c),rows:"15","data-dblclick":"原文已复制到剪贴板"},null,8,["modelValue","onDblclick"])])),_:1}),A(n,{span:11},{default:K((()=>[A(f,{modelValue:P.value,"onUpdate:modelValue":l[4]||(l[4]=e=>P.value=e),class:"ciphertext-input",placeholder:"密文",type:"textarea",onDblclick:m(c),rows:"15","data-dblclick":"密文已复制到剪贴板"},null,8,["modelValue","onDblclick"])])),_:1})])),_:1})],64)}}}),[["__scopeId","data-v-1badc5a9"]]);export{M as default};
